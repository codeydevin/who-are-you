<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Orbit Moire Lab</title>
  <style>
    :root {
      --ink: #101216;
      --obsidian: #0a0d12;
      --slate: #d8d3c8;
      --frost: #9fc6c2;
      --amber: #f0b56a;
      --rose: #c9756b;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
      background:
        radial-gradient(circle at 15% 15%, rgba(159, 198, 194, 0.12), transparent 45%),
        radial-gradient(circle at 80% 20%, rgba(240, 181, 106, 0.18), transparent 48%),
        linear-gradient(150deg, #07090e 0%, #0d1018 55%, #161b24 100%);
      color: var(--slate);
      font-family: "Cinzel", "Garamond", "Palatino Linotype", serif;
    }

    .shell {
      width: min(1160px, 95vw);
      background: rgba(10, 13, 18, 0.88);
      border: 1px solid rgba(216, 211, 200, 0.08);
      border-radius: 28px;
      padding: 26px;
      display: grid;
      gap: 20px;
      box-shadow: 0 30px 70px rgba(0, 0, 0, 0.45);
      animation: rise 600ms ease-out;
    }

    header {
      display: flex;
      flex-wrap: wrap;
      align-items: baseline;
      justify-content: space-between;
      gap: 14px;
    }

    h1 {
      margin: 0;
      font-size: clamp(1.7rem, 2.6vw, 2.4rem);
      letter-spacing: 0.04em;
    }

    .subtitle {
      color: rgba(216, 211, 200, 0.6);
      font-size: 0.95rem;
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(230px, 300px) 1fr;
      gap: 22px;
    }

    .controls {
      background: rgba(17, 21, 30, 0.75);
      border-radius: 18px;
      padding: 16px;
      border: 1px solid rgba(216, 211, 200, 0.08);
      display: grid;
      gap: 12px;
      align-content: start;
    }

    .control {
      display: grid;
      gap: 6px;
    }

    label {
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: rgba(216, 211, 200, 0.65);
    }

    input[type="range"] {
      width: 100%;
    }

    .row {
      display: flex;
      justify-content: space-between;
      font-size: 0.82rem;
      color: rgba(216, 211, 200, 0.7);
    }

    button {
      padding: 10px 14px;
      border-radius: 999px;
      border: 1px solid rgba(216, 211, 200, 0.2);
      background: transparent;
      color: var(--slate);
      cursor: pointer;
      font-family: inherit;
      transition: transform 140ms ease, border-color 140ms ease, color 140ms ease;
    }

    button:hover {
      transform: translateY(-1px);
      border-color: var(--amber);
      color: var(--amber);
    }

    canvas {
      width: 100%;
      height: 100%;
      min-height: 520px;
      border-radius: 18px;
      background: radial-gradient(circle at 40% 40%, rgba(201, 117, 107, 0.08), transparent 55%),
        rgba(9, 12, 18, 0.8);
      border: 1px solid rgba(216, 211, 200, 0.08);
      display: block;
    }

    .note {
      font-size: 0.85rem;
      color: rgba(216, 211, 200, 0.6);
      line-height: 1.5;
    }

    @keyframes rise {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @media (max-width: 900px) {
      .layout {
        grid-template-columns: 1fr;
      }

      canvas {
        min-height: 420px;
      }
    }
  </style>
</head>
<body>
  <main class="shell">
    <header>
      <div>
        <h1>Orbit Moire Lab</h1>
        <div class="subtitle">Layered orbital rings that drift into interference fields.</div>
      </div>
      <button id="toggle">Pause</button>
    </header>

    <section class="layout">
      <div class="controls">
        <div class="control">
          <label for="rings">Rings</label>
          <input id="rings" type="range" min="6" max="24" value="14" />
          <div class="row"><span>Few</span><span>Many</span></div>
        </div>
        <div class="control">
          <label for="spokes">Spokes</label>
          <input id="spokes" type="range" min="4" max="24" value="12" />
          <div class="row"><span>Soft</span><span>Sharp</span></div>
        </div>
        <div class="control">
          <label for="wobble">Wobble</label>
          <input id="wobble" type="range" min="5" max="80" value="35" />
          <div class="row"><span>Low</span><span>High</span></div>
        </div>
        <div class="control">
          <label for="drift">Drift Speed</label>
          <input id="drift" type="range" min="2" max="40" value="14" />
          <div class="row"><span>Glide</span><span>Spin</span></div>
        </div>
        <div class="control">
          <label for="hue">Hue Shift</label>
          <input id="hue" type="range" min="0" max="180" value="45" />
          <div class="row"><span>Cool</span><span>Warm</span></div>
        </div>
        <button id="shuffle">New Phase</button>
        <p class="note">
          Tip: drag rings down, then increase wobble for a low-density interference field.
        </p>
      </div>
      <canvas id="field" width="900" height="650"></canvas>
    </section>
  </main>

  <script>
    const canvas = document.getElementById("field");
    const ctx = canvas.getContext("2d");
    const controls = {
      rings: document.getElementById("rings"),
      spokes: document.getElementById("spokes"),
      wobble: document.getElementById("wobble"),
      drift: document.getElementById("drift"),
      hue: document.getElementById("hue")
    };
    const toggle = document.getElementById("toggle");
    const shuffle = document.getElementById("shuffle");

    let running = true;
    let phaseOffset = Math.random() * Math.PI * 2;
    let time = 0;

    const resize = () => {
      const { width, height } = canvas.getBoundingClientRect();
      const ratio = window.devicePixelRatio || 1;
      canvas.width = Math.round(width * ratio);
      canvas.height = Math.round(height * ratio);
      ctx.setTransform(ratio, 0, 0, ratio, 0, 0);
    };

    const ringColor = (index, total, hueShift) => {
      const base = 190 + hueShift + index * (130 / total);
      const lightness = 48 + Math.sin(index * 0.5) * 12;
      return `hsl(${base % 360}, 52%, ${lightness}%)`;
    };

    const draw = () => {
      const { width, height } = canvas.getBoundingClientRect();
      const centerX = width / 2;
      const centerY = height / 2;
      const ringCount = Number(controls.rings.value);
      const spokes = Number(controls.spokes.value);
      const wobble = Number(controls.wobble.value);
      const driftSpeed = Number(controls.drift.value) / 100;
      const hueShift = Number(controls.hue.value);

      ctx.clearRect(0, 0, width, height);
      ctx.globalCompositeOperation = "lighter";
      ctx.lineWidth = 1.15;

      for (let r = 0; r < ringCount; r += 1) {
        const radius = 70 + r * ((Math.min(width, height) * 0.42) / ringCount);
        const localPhase = phaseOffset + r * 0.6;
        ctx.strokeStyle = ringColor(r, ringCount, hueShift);
        ctx.beginPath();

        const segments = 240;
        for (let i = 0; i <= segments; i += 1) {
          const angle = (Math.PI * 2 * i) / segments;
          const wobbleFactor = Math.sin(angle * spokes + time * driftSpeed + localPhase);
          const drift = Math.cos(angle * (spokes - 2) - time * driftSpeed * 0.6 + localPhase);
          const offset = (wobbleFactor * wobble + drift * (wobble * 0.4)) * (1 - r / (ringCount + 2));
          const x = centerX + Math.cos(angle) * (radius + offset);
          const y = centerY + Math.sin(angle) * (radius + offset * 0.8);

          if (i === 0) {
            ctx.moveTo(x, y);
          } else {
            ctx.lineTo(x, y);
          }
        }
        ctx.stroke();
      }
      ctx.globalCompositeOperation = "source-over";
    };

    const tick = () => {
      if (running) {
        time += 0.02;
        draw();
      }
      requestAnimationFrame(tick);
    };

    toggle.addEventListener("click", () => {
      running = !running;
      toggle.textContent = running ? "Pause" : "Resume";
      if (running) {
        draw();
      }
    });

    shuffle.addEventListener("click", () => {
      phaseOffset = Math.random() * Math.PI * 2;
      draw();
    });

    window.addEventListener("resize", () => {
      resize();
      draw();
    });

    resize();
    draw();
    tick();
  </script>
</body>
</html>
